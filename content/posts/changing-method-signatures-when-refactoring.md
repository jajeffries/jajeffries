---
title: 'Changing method signatures when refactoring'
date: Fri, 24 Apr 2015 11:51:51 +0000
draft: false
tags: []
---

I've been practicing refactoring a lot recently (I'm talking about it in a session with [@kevinrutherford](https://twitter.com/kevinrutherford) at [Agile Manchester](http://agilemanchester.net/2015/sessions/index.php?session=18) in a few weeks) and I've found a pattern that I wasn't aware of before. When changing a method signature by changing the parameters I found I was going too long without running my tests as my code wouldn't compile. So imagine I have a TheatrePerformance class which is responsible for keeping track of which seats are available and taken for a theatre performance. It might look something like this \[code\] class TheatrePerformance def initialize(available\_seats:\[\], taken\_seats:\[\]) @available\_seats = available\_seats @taken\_seats = taken\_seats end def book(seat\_number:) @available\_seats.delete(seat\_number) @taken\_seats.push(seat\_number) # ... some other stuff ... end end \[/code\] And I want to start using a bookings object which encapsulates the two parameters and gives us a better abstraction. Previously my first step would be to pass that in as a parameter. \[code\] class TheatrePerformance def initialize(bookings:) @available\_seats = available\_seats @taken\_seats = taken\_seats end def book(seat\_number:) @available\_seats.delete(seat\_number) @taken\_seats.push(seat\_number) # ... some other stuff ... end end \[/code\] Straight away I can't meaningfully run my tests anymore to verify what I'm doing because the constructor is invalid. So instead if I **add** a parameter and don't use it yet then I can still run my tests to check I've not broken anything. \[code\] class TheatrePerformance def initialize(available\_seats:\[\], taken\_seats:\[\], bookings:) @available\_seats = available\_seats @taken\_seats = taken\_seats end def book(seat\_number:) @available\_seats.delete(seat\_number) @taken\_seats.push(seat\_number) # ... some other stuff ... end end \[/code\] And then change the rest of the code to use the new parameter before removing the other constructor parameters. \[code\] class TheatrePerformance def initialize(available\_seats:\[\], taken\_seats:\[\], bookings:) @available\_seats = available\_seats @taken\_seats = taken\_seats @bookings = bookings end def book(seat\_number:) @available\_seats.delete(seat\_number) @taken\_seats.push(seat\_number) # ... some other stuff ... end end \[/code\] to \[code\] class TheatrePerformance def initialize(available\_seats:\[\], taken\_seats:\[\], bookings:) @bookings = bookings end def book(seat\_number:) @bookings.book(seat\_number) # ... some other stuff ... end end \[/code\] to \[code\] class TheatrePerformance def initialize(bookings:) @bookings = bookings end def book(seat\_number:) @bookings.book(seat\_number) # ... some other stuff ... end end \[/code\] I've found this really useful as it lets me take really small steps, which minimises how much I have to think about before when making a change.